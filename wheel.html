<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lucky Wheel üé°</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background: #ffe6f0;
      font-family: 'Arial', sans-serif;
    }
    h2 {
      margin-bottom: 20px;
      font-size: 28px;
      color: #d63384;
    }
    canvas {
      border: 8px solid #ff4d6d;
      border-radius: 50%;
      background: #fff0f6;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 18px;
      background: #ff4d6d;
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #d63384;
    }
    #resultCard {
      margin-top: 30px;
      padding: 20px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(255, 77, 109, 0.4);
      text-align: center;
      width: 280px;
      display: none;
      animation: fadeIn 0.6s ease-in-out;
    }
    #resultText {
      font-size: 22px;
      font-weight: bold;
      color: #ff4d6d;
      text-shadow: 0 0 8px #ff99ac;
      margin-bottom: 15px;
    }
    #downloadBtn {
      padding: 8px 14px;
      font-size: 16px;
      background: #ff6f91;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    #downloadBtn:hover {
      background: #d63384;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: scale(0.8);}
      to {opacity: 1; transform: scale(1);}
    }
  </style>
</head>
<body>
  <h2>Spin the Lucky Wheel üé°</h2>
  <canvas id="wheelCanvas" width="400" height="400"></canvas>
  <button onclick="spinWheel()">Spin</button>

  <!-- Result Card -->
  <div id="resultCard">
    <div id="resultText"></div>
    <button id="downloadBtn" onclick="downloadCard()">Download üíæ</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    const options = [
      "Hug ü§ó",
      "Keep hands on thigh ‚úã",
      "1 period sitting together ‚è≥",
      "1 photo üì∏",
      "Study together üìñ",
      "Click one photo with me ‚ù§Ô∏è"
    ];

    const colors = ["#ff4d6d","#ff6f91","#ff85a2","#ff99ac","#ffb3c6","#ffccd5"];

    let canvas = document.getElementById("wheelCanvas");
    let ctx = canvas.getContext("2d");
    let startAngle = 0;
    let arc = Math.PI / (options.length / 2);
    let spinTimeout = null;
    let spinAngleStart = 0;
    let spinTime = 0;
    let spinTimeTotal = 0;

    function drawRouletteWheel() {
      ctx.clearRect(0,0,400,400);
      ctx.strokeStyle = "white";
      ctx.lineWidth = 2;
      ctx.font = "16px Arial";
      for(let i = 0; i < options.length; i++) {
        let angle = startAngle + i * arc;
        ctx.fillStyle = colors[i % colors.length];
        ctx.beginPath();
        ctx.arc(200, 200, 200, angle, angle + arc, false);
        ctx.arc(200, 200, 0, angle + arc, angle, true);
        ctx.fill();
        ctx.save();
        ctx.fillStyle = "white";
        ctx.translate(200 + Math.cos(angle + arc/2) * 120,
                      200 + Math.sin(angle + arc/2) * 120);
        ctx.rotate(angle + arc/2);
        ctx.fillText(options[i], -ctx.measureText(options[i]).width/2, 0);
        ctx.restore();
      }
      // Arrow
      ctx.fillStyle = "#d63384";
      ctx.beginPath();
      ctx.moveTo(200 - 10, 0);
      ctx.lineTo(200 + 10, 0);
      ctx.lineTo(200, 40);
      ctx.closePath();
      ctx.fill();
    }

    function rotateWheel() {
      spinTime += 30;
      if(spinTime >= spinTimeTotal) {
        stopRotateWheel();
        return;
      }
      let spinAngle = spinAngleStart - easeOut(spinTime, 0, spinAngleStart, spinTimeTotal);
      startAngle += (spinAngle * Math.PI / 180);
      drawRouletteWheel();
      spinTimeout = setTimeout(rotateWheel, 30);
    }

    function stopRotateWheel() {
      clearTimeout(spinTimeout);
      let degrees = startAngle * 180 / Math.PI + 90;
      let arcd = arc * 180 / Math.PI;
      let index = Math.floor((360 - (degrees % 360)) / arcd);
      ctx.save();
      let resultText = options[index];
      ctx.restore();
      
      // Show card
      const resultCard = document.getElementById("resultCard");
      const resultDiv = document.getElementById("resultText");
      resultDiv.textContent = "üíñ Result: " + resultText;
      resultCard.style.display = "block";

      // Confetti
      launchConfetti();
    }

    function easeOut(t, b, c, d) {
      const ts = (t/=d)*t;
      const tc = ts*t;
      return b+c*(tc + -3*ts + 3*t);
    }

    function spinWheel() {
      document.getElementById("resultCard").style.display = "none";
      spinAngleStart = Math.random() * 10 + 10;
      spinTime = 0;
      spinTimeTotal = Math.random() * 3000 + 4000;
      rotateWheel();
    }

    // Confetti effect
    function launchConfetti() {
      for (let i = 0; i < 80; i++) {
        const confetti = document.createElement("div");
        confetti.style.position = "fixed";
        confetti.style.width = "8px";
        confetti.style.height = "14px";
        confetti.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
        confetti.style.top = "-10px";
        confetti.style.left = Math.random()*100 + "vw";
        confetti.style.opacity = Math.random();
        confetti.style.transform = "rotate(" + Math.random()*360 + "deg)";
        document.body.appendChild(confetti);

        let fall = setInterval(() => {
          let top = parseFloat(confetti.style.top);
          if (top > window.innerHeight) {
            confetti.remove();
            clearInterval(fall);
          } else {
            confetti.style.top = top + 5 + "px";
          }
        }, 30);
      }
    }

    // Download Card
    function downloadCard() {
      html2canvas(document.querySelector("#resultCard")).then(canvas => {
        let link = document.createElement("a");
        link.download = "LuckyWheel_Result.png";
        link.href = canvas.toDataURL();
        link.click();
      });
    }

    drawRouletteWheel();
  </script>
  <script>
(() => {
  let last = 0;

  function spawn(x, y, emoji = "üíï") {
    const el = document.createElement("div");
    el.textContent = emoji;            // change to "üéà" if you prefer balloons
    el.style.position = "fixed";
    el.style.left = x + "px";
    el.style.top = y + "px";
    el.style.transform = "translate(-50%, -50%)";
    el.style.fontSize = "20px";
    el.style.opacity = "0.9";
    el.style.pointerEvents = "none";
    el.style.zIndex = "9999";          // always on top
    document.body.appendChild(el);

    // animate floating up & fading
    requestAnimationFrame(() => {
      el.style.transition = "all 900ms ease";
      el.style.top = (y - 40) + "px";
      el.style.opacity = "0";
    });

    setTimeout(() => el.remove(), 950);
  }

  // Show hearts everywhere mouse moves
  window.addEventListener("mousemove", (e) => {
    const now = performance.now();
    if (now - last < 60) return; // throttle so it‚Äôs not too heavy
    last = now;
    spawn(e.clientX, e.clientY);
  });
})();
</script>
</body>
</html>
